## Value Objects - Объекты значений

`Value Object` - это некоторый объект в принципах DDD, который является состоянием Entity (сущности), которая владеет определенным более мелкими компонентом. Иными словами, Value Object - это строительный кирпичик для сущности.

Пример:
- Пользователь (Entity) имеет почтовый адресс (Value Object)
- Корабль (Entity) имеет грузоподъемность (Value Object)
- Игровая карта (Entity) имеет метки (Value Objects)

<br>

### Когда стоит использовать?

- Если мы хотим создать в нашей системе описательный объект, который лишен идентичности и определяет состояние некой сущности
    
    Пример: Банковский аккаунт **BankAccount** является сущностью, а Количество денег **Money** является ValueObject. Во многих предметных областях количество денег не может быть идентифицированно каким-то атрибутом. Этот объект лишен очевидной идентичности. Money нам нужен только для того, чтобы задавать состояние BankAccount. 

    ```python
    from dataclasses import dataclass
    from enum import Enum
    from uuid import UUID, uuid5
    
    from src.domain.base import BaseValueObject, BaseEntity  # Must be implemented!


    class Currency(int, Enum):
        RUB = 0
        EUR = 1
        USD = 2


    @dataclass(frozen=True)  # ValueObject (Descriptive object, represents the state of entity, no apparent identity)
    class Money(BaseValueObject):
        amount: int
        currency: Currency


    class BankAccount(BaseEntity):  # Entity
        def __init__(self, start_balance: Money):
            self.identifier: UUID = uuid5()
            self.balance = start_balance

    ```

- Если нам нужно усилить ясность/понятность компонентов сущности

    Пример: У товара **Product** (Entity) должна быть цена **Price**. Если цена у нас будет представлена обычным числом типа int, то в нашей системе возникнет две большие проблемы:
        
    - Объект цены никак не сможет провалидировать свою инициализацию. Вдруг мы передали какое-то отрицательное значение или объект другого типа?
    - Непонятно, какая единица измерения у цены, какая валюта. Это золотые монеты? Или может 5-долларовые банкоты?

    Все это может привести к неочевидности и двусмысленности, при этом будут скрыты важные понятие в предметной области приложения


<br>

### Свойства Value Objects

1) `Отсутствие идентичности`. Value Objects не имеют каких-либо идентификаторов

2) `Сравнение на основе атрибутов`. 2 Value Objects считаются одинаковыми только в том случае, когда каждый соответствующий атрибут 1-го Value Object равен каждому соответствующему атрибуту 2-го Value Object

3) `Богатое поведение`. Все Value Objects должны по максимому раскрывать поведение компонента в рамках предметной области

4) `Неизменяемость`. Value Objects по своей сути являются неизменяемыми объектами. Если мы хотим у некоторой сущности поменять какой-то компонент, являющийся Value Object, мы должны создать новый Value Object с другими параметрами и присвоить соответствующему полю новый созданный объект.

5) `Комбинированность`. Если Value Object является оберткой над каким-то числовым объектом, мы можем переопределить арифметические операторы: \_\_add__() \_\_sub__() \_\_mul__() \_\_div__(), тем самым добавив доболнительную логику в нашу предметную модель

6) `Валидация`. Каждый Value Object по определению должен находиться в корректном состоянии. Чтобы добиться этого, мы должны валидировать данные, на основе которых строится Value Object.